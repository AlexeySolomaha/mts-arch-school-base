# ADR.003 Оценка перехода платформы конференций на MongoDB с реляционной при добавлении LMS-функции в систему

* Статус: **Предложено**
* Владелец: **aisolomakh@mts.ru**

## Контекст
Необходимо оценить вохможность перехода приложении **сайт конференции helloconf** на MongoDB при добавлении LMS (Learning Management System — Система управления обучением) на платформу. Примерный перечень добавляемых видов данных:
* план мероприятий
* ссылка на материалы
* текст домашнего задания

## Варианты решения
### Вариант 1. Переход всей системы на MonogDB
Необходимо выполнить перевод всей системы на MongoDB
* перепроектировать схему данных с реляционной на документную
* переделать кодовую базу для использования MongoDB вместореляционной
* произвести миграцию данных из используемой РСУБД в MongoDB
* развернуть MongoDB на стендах разработки, тестирования и промышленном.

Плюсы:
* Выигрываем в хранении документной части данных - как материалов конференций, так и материалов для обучения (материалы для изучения и присланные домашние задания обучающихся), так как теперь имеем AD (по ACID) и CP (по CAP)
* Хоршее положение на техрадаре МТС у MongoDB.
* Для формирования и усовершенствования модели данных добавляемого функционала LMS получаем легко поддающийся изменению формат схемы данных MongoDB
* Решается вопрос с возможным быстрым ростом данных.

Минусы:
* Большой объём работ по переводу уже существующего кода системы с РСУБД на MongoDB.
* Необходимость миграции данных с измененем их формата.
* Теряется часть преимуществ ACID-системы на основе нашей РСУБД, необходимых для хранения чувствительных к целостности данных, которые необходимо обарабатывать при помощи транзакций.
* Необходимо корректировать состав или компетенции команды разработчиков - с копетенции по работе с РСУБД на MongoDB.

## Вариант 2. Остаёмся с существующей РСУБД.
Плюсы:
* Часть данных системы, чувствительных к консистентности и строгой типизации использует все преимущества ACID-системы
* Нет затрат на дообучение команды разработчиков - она продолжает использовать заявленные при наборе команды компетенции.
* Не нужно перепроектировать схему данных, нужно только добавить новые модели.
Минусы:
* При большом росте объёмов данных необходимо решать вопросы с масштабированием
* К "документной" части данных будет иметь неоптимальный доступ на чтение по сравнению с MongoDB (не такой быстрый).
* Избыточная строгость при сохранении документных данных в формате РСУБД.

## Вариант 3. Комбинированный вариант РСУБД + MongoDB
В этом варианте предлагается изпользование как существующей РСУБД, так и MongoDB с разделением хранения данных по их типу: документные данные - в MongoDB, данные о пользователях, рецензиях, распианиях, выполненных домашних заданиях и прочих, требующих консистентности и транзакционной обработки.
Плюсы:
* Каждый тип данных получает "правильное" хранилище
* Не используются транзакции для хранения и предоставления доступа к документам конференций и системы обучения, так как это избыточно.
* Для работы с пользователями, расписаниями и другими данными, чувствительными к консистенности транзакции наоборот - применяются
* Повышается мотивация команд разработки за счёт применения разносторонних технологий хранения и обработки данных.
* Разработку можно вести с помощью двух или несколько команд, разделив объём работ по техноологиям хранения данных.
* Огромный выбор языков программирования и технологий доступа к данным для MongoDB
* Лёгкость развёртывания MongoDB - относительно небольшие затраты для развёртывания второй системы
* Документная часть данных в системе наиболее подвержена росту - с увеличением количества данных MongoDB справляется относительно легко из-за технологий масштабирования.
Минусы:
* Плюс одна технология в стеке - добавляются требования к командам разработки
* Ещё один тип хранилища нужно разворачивать и поддерживать.
* Невозможно реализовать валидацию данных и бизнес-логику на уровне базы данных.


## Решение
Для планируемой системы проведения конференций с расширением до LMS(система дистанционного обучения) предлагается вариант 3 - с разделением данных по типу. С документоориентированными данными работать при помощи MongoDB. Для данных, требующих более организованной структуры и транзакционной обработки - использовать реляционную СУБД. Предполагается, что положительный эффект от выбора будет накапливаться по мере роста объёма данных, так как ожидается, что объём документообразных данных будет расти гораздо быстрее данных РСУБД.
